$(function(){"use strict";module("collapse plugin"),test("should be defined on jquery object",function(){ok($(document.body).collapse,"collapse method is defined")}),module("collapse",{setup:function(){$.fn.bootstrapCollapse=$.fn.collapse.noConflict()},teardown:function(){$.fn.collapse=$.fn.bootstrapCollapse,delete $.fn.bootstrapCollapse}}),test("should provide no conflict",function(){strictEqual($.fn.collapse,void 0,"collapse was set back to undefined (org value)")}),test("should return jquery collection containing the element",function(){var a=$("<div/>"),e=a.bootstrapCollapse();ok(e instanceof $,"returns jquery collection"),strictEqual(e[0],a[0],"collection contains element")}),test("should show a collapsed element",function(){var a=$('<div class="collapse"/>').bootstrapCollapse("show");ok(a.hasClass("in"),'has class "in"'),ok(!/height/i.test(a.attr("style")),"has height reset")}),test("should hide a collapsed element",function(){var a=$('<div class="collapse"/>').bootstrapCollapse("hide");ok(!a.hasClass("in"),'does not have class "in"'),ok(/height/i.test(a.attr("style")),"has height set")}),test("should not fire shown when show is prevented",function(){stop(),$('<div class="collapse"/>').on("show.bs.collapse",function(a){a.preventDefault(),ok(!0,"show event fired"),start()}).on("shown.bs.collapse",function(){ok(!1,"shown event fired")}).bootstrapCollapse("show")}),test("should reset style to auto after finishing opening collapse",function(){stop(),$('<div class="collapse" style="height: 0px"/>').on("show.bs.collapse",function(){equal(this.style.height,"0px","height is 0px")}).on("shown.bs.collapse",function(){strictEqual(this.style.height,"","height is auto"),start()}).bootstrapCollapse("show")}),test('should remove "collapsed" class from target when collapse is shown',function(){stop();var a=$('<a data-toggle="collapse" class="collapsed" href="#test1"/>').appendTo("#qunit-fixture");$('<div id="test1"/>').appendTo("#qunit-fixture").on("shown.bs.collapse",function(){ok(!a.hasClass("collapsed")),start()}),a.click()}),test('should add "collapsed" class to target when collapse is hidden',function(){stop();var a=$('<a data-toggle="collapse" href="#test1"/>').appendTo("#qunit-fixture");$('<div id="test1" class="in"/>').appendTo("#qunit-fixture").on("hidden.bs.collapse",function(){ok(a.hasClass("collapsed")),start()}),a.click()}),test('should not close a collapse when initialized with "show" if already shown',function(){stop(),expect(0);var a=$('<div id="test1" class="in"/>').appendTo("#qunit-fixture").on("hide.bs.collapse",function(){ok(!1)});a.bootstrapCollapse("show"),setTimeout(start,0)}),test('should open a collapse when initialized with "show" if not already shown',function(){stop(),expect(1);var a=$('<div id="test1" />').appendTo("#qunit-fixture").on("show.bs.collapse",function(){ok(!0)});a.bootstrapCollapse("show"),setTimeout(start,0)}),test('should remove "collapsed" class from active accordion target',function(){stop();var a='<div class="panel-group" id="accordion"><div class="panel"/><div class="panel"/><div class="panel"/></div>',e=$(a).appendTo("#qunit-fixture").find(".panel"),o=$('<a data-toggle="collapse" href="#body1" data-parent="#accordion"/>').appendTo(e.eq(0));$('<div id="body1" class="in"/>').appendTo(e.eq(0));var s=$('<a class="collapsed" data-toggle="collapse" href="#body2" data-parent="#accordion"/>').appendTo(e.eq(1));$('<div id="body2"/>').appendTo(e.eq(1));var t=$('<a class="collapsed" data-toggle="collapse" href="#body3" data-parent="#accordion"/>').appendTo(e.eq(2));$('<div id="body3"/>').appendTo(e.eq(2)).on("shown.bs.collapse",function(){ok(o.hasClass("collapsed"),'inactive target 1 does have class "collapsed"'),ok(s.hasClass("collapsed"),'inactive target 2 does have class "collapsed"'),ok(!t.hasClass("collapsed"),'active target 3 does not have class "collapsed"'),start()}),t.click()}),test("should allow dots in data-parent",function(){stop();var a='<div class="panel-group accordion"><div class="panel"/><div class="panel"/><div class="panel"/></div>',e=$(a).appendTo("#qunit-fixture").find(".panel"),o=$('<a data-toggle="collapse" href="#body1" data-parent=".accordion"/>').appendTo(e.eq(0));$('<div id="body1" class="in"/>').appendTo(e.eq(0));var s=$('<a class="collapsed" data-toggle="collapse" href="#body2" data-parent=".accordion"/>').appendTo(e.eq(1));$('<div id="body2"/>').appendTo(e.eq(1));var t=$('<a class="collapsed" data-toggle="collapse" href="#body3" data-parent=".accordion"/>').appendTo(e.eq(2));$('<div id="body3"/>').appendTo(e.eq(2)).on("shown.bs.collapse",function(){ok(o.hasClass("collapsed"),'inactive target 1 does have class "collapsed"'),ok(s.hasClass("collapsed"),'inactive target 2 does have class "collapsed"'),ok(!t.hasClass("collapsed"),'active target 3 does not have class "collapsed"'),start()}),t.click()}),test('should set aria-expanded="true" on target when collapse is shown',function(){stop();var a=$('<a data-toggle="collapse" class="collapsed" href="#test1" aria-expanded="false"/>').appendTo("#qunit-fixture");$('<div id="test1"/>').appendTo("#qunit-fixture").on("shown.bs.collapse",function(){equal(a.attr("aria-expanded"),"true",'aria-expanded on target is "true"'),start()}),a.click()}),test('should set aria-expanded="false" on target when collapse is hidden',function(){stop();var a=$('<a data-toggle="collapse" href="#test1" aria-expanded="true"/>').appendTo("#qunit-fixture");$('<div id="test1" class="in"/>').appendTo("#qunit-fixture").on("hidden.bs.collapse",function(){equal(a.attr("aria-expanded"),"false",'aria-expanded on target is "false"'),start()}),a.click()}),test('should change aria-expanded from active accordion target to "false" and set the newly active one to "true"',function(){stop();var a='<div class="panel-group" id="accordion"><div class="panel"/><div class="panel"/><div class="panel"/></div>',e=$(a).appendTo("#qunit-fixture").find(".panel"),o=$('<a data-toggle="collapse" href="#body1" data-parent="#accordion"/>').appendTo(e.eq(0));$('<div id="body1" aria-expanded="true" class="in"/>').appendTo(e.eq(0));var s=$('<a class="collapsed" data-toggle="collapse" href="#body2" data-parent="#accordion"/>').appendTo(e.eq(1));$('<div id="body2" aria-expanded="false"/>').appendTo(e.eq(1));var t=$('<a class="collapsed" data-toggle="collapse" href="#body3" data-parent="#accordion"/>').appendTo(e.eq(2));$('<div id="body3" aria-expanded="false"/>').appendTo(e.eq(2)).on("shown.bs.collapse",function(){equal(o.attr("aria-expanded"),"false",'inactive target 1 has aria-expanded="false"'),equal(s.attr("aria-expanded"),"false",'inactive target 2 has aria-expanded="false"'),equal(t.attr("aria-expanded"),"true",'active target 3 has aria-expanded="false"'),start()}),t.click()}),test("should not fire show event if show is prevented because other element is still transitioning",function(){stop();var a='<div id="accordion"><div class="panel"/><div class="panel"/></div>',e=!1,o=$(a).appendTo("#qunit-fixture").find(".panel"),s=$('<a data-toggle="collapse" href="#body1" data-parent="#accordion"/>').appendTo(o.eq(0));$('<div id="body1" class="collapse"/>').appendTo(o.eq(0)).on("show.bs.collapse",function(){e=!0});var t=$('<a data-toggle="collapse" href="#body2" data-parent="#accordion"/>').appendTo(o.eq(1)),l=$('<div id="body2" class="collapse"/>').appendTo(o.eq(1));t.click(),l.toggleClass("in collapsing").data("bs.collapse").transitioning=1,s.click(),setTimeout(function(){ok(!e,"show event didn't fire"),start()},1)}),test('should add "collapsed" class to target when collapse is hidden via manual invocation',function(){stop();var a=$('<a data-toggle="collapse" href="#test1"/>').appendTo("#qunit-fixture");$('<div id="test1" class="in"/>').appendTo("#qunit-fixture").on("hidden.bs.collapse",function(){ok(a.hasClass("collapsed")),start()}).bootstrapCollapse("hide")}),test('should remove "collapsed" class from target when collapse is shown via manual invocation',function(){stop();var a=$('<a data-toggle="collapse" class="collapsed" href="#test1"/>').appendTo("#qunit-fixture");$('<div id="test1"/>').appendTo("#qunit-fixture").on("shown.bs.collapse",function(){ok(!a.hasClass("collapsed")),start()}).bootstrapCollapse("show")})});